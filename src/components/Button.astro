---
interface Props {
	href?: string;
	type?: "button" | "submit" | "reset";
	variant?: "primary" | "secondary" | "ghost" | "success" | "warning" | "error";
	size?: "sm" | "md" | "lg";
	icon?: string | string[];
	disabled?: boolean;
	class?: string;
	target?: string;
	rel?: string;
}

const {
	href,
	type = "button",
	variant = "primary",
	size = "md",
	icon,
	disabled = false,
	class: className = "",
	target,
	rel,
} = Astro.props as Props;

const baseClass =
	"inline-flex items-center justify-center gap-2 rounded-xl border border-transparent font-medium transition-[background-color,color,border-color,box-shadow,transform] duration-200 ease-out focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 active:scale-[0.99] disabled:cursor-not-allowed disabled:opacity-50";

const variantClasses = {
	primary:
		"bg-zinc-100 text-zinc-950 shadow-sm hover:bg-white hover:shadow-md focus-visible:outline-zinc-300",
	secondary:
		"bg-white/10 text-gray-200 shadow-sm hover:bg-white/20 hover:text-white hover:border-white/20 hover:shadow-md focus-visible:outline-gray-400",
	ghost:
		"bg-transparent text-gray-300 hover:bg-white/10 hover:text-white hover:border-white/20 focus-visible:outline-gray-400",
	success:
		"bg-teal-500 text-white shadow-sm hover:bg-teal-600 hover:shadow-md focus-visible:outline-teal-500",
	warning:
		"bg-amber-500 text-white shadow-sm hover:bg-amber-600 hover:shadow-md focus-visible:outline-amber-500",
	error:
		"bg-rose-500 text-white shadow-sm hover:bg-rose-600 hover:shadow-md focus-visible:outline-rose-500",
};

const sizeClasses = {
	sm: "px-3 py-1.5 text-sm",
	md: "px-4 py-2 text-base",
	lg: "px-5 py-2.5 text-base",
};

const iconClasses = Array.isArray(icon)
	? icon.filter(Boolean)
	: icon
		? icon.split(" ").filter(Boolean)
		: [];

const classes = `${baseClass} ${variantClasses[variant]} ${sizeClasses[size]} ${className}`;
const safeRel = rel ?? (target === "_blank" ? "noopener noreferrer" : undefined);
---

{
	href ? (
		<a href={href} target={target} rel={safeRel} aria-disabled={disabled} class={classes}>
			{iconClasses.length > 0 && <i aria-hidden="true" class:list={[...iconClasses, "shrink-0", "text-[0.95em]"]} />}
			<slot />
		</a>
	) : (
		<button type={type} disabled={disabled} class={classes}>
			{iconClasses.length > 0 && <i aria-hidden="true" class:list={[...iconClasses, "shrink-0", "text-[0.95em]"]} />}
			<slot />
		</button>
	)
}
